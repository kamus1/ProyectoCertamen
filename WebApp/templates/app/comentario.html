{% extends 'app/base.html' %}

{% load static %}

{% block contenido %}

<div class="elContenedor">

    <div class="preguntas mb-3" style="max-width: 800px;">
        <div class="card-header"><i style="float: left; "class="svg-inline--fa fas fa-user-circle fa-2x">&nbsp;</i> <p style="display: inline-block; ">{{instance.usuario.first_name}}{{" "}}{{instance.usuario.last_name}}</p> &nbsp;<h7 style="color: gray; font-size: 10px;">{{instance.tiempo}}</h7></div>
        <div class="card-body">
            <h5 class="card-title">
                <!--posible titulo de la pregunta-->
            </h5>
            <p class="card-text">
                <h2>{{instance.texto}}</h2>
            </p>

            <div>
                <p>Escribir comentario:</p>
                <form method="post">
                    {% csrf_token %}
                    {{form.as_p}}

                    <button class="btn btn-success" type="submit">
                        comentar
                    </button>
                </form>

            </div>

            {{ver_comentario.count}}
            {% for ver_comentario in ver_comentario %}
            <div>
                <div class="preguntas mb-3" style="max-width: 500px;">

                    <div class="card-header"><i style="float: left; "class="svg-inline--fa fas fa-user-circle fa-2x">&nbsp;</i> <p style="display: inline-block; ">{{ver_comentario.usuario.first_name}}{{" "}}{{ver_comentario.usuario.last_name}}</p> &nbsp;<h7 style="color: gray; font-size: 10px;">{{ver_comentario.tiempo}}</h7></div> 
                    <div class="card-body">
                        <h5 class="card-title"></h5>
                        <p class="card-text">
                                <h5 href=>{{ver_comentario.texto}} </h5>
                            </p>
                            {% if request.user == ver_comentario.usuario %}
                            <a href="{% url 'eliminar' ver_comentario.id %}">
                                <br><button class="btn btn-danger">Eliminar Comentario</button> 
                            </a>
                            {% endif %}
                        
                    </div>
                </div>
                

                <button class="b_responder btn " style="margin-bottom: 10px;">
                    Responder
                </button>
                <div class="abrir_caja">
                    <form method="post" action="">
                        {% csrf_token %}
                        <input type="hidden" name="padre_identificador" value="{{ver_comentario.id}}">
                        {{form}}
                        <button type="submit" class="btn btn-success" style="margin-top: 10px;">
                            Enviar respuesta
                        </button>
                    </form>

                    <div>
                        {%for respuesta in ver_comentario.hijo %}
                        <div>
                            <span>
                                {{respuesta.usuario.first_name}}{{" "}}{{respuesta.usuario.last_name}}
                                {{respuesta.texto}}
                            </span>
                        </div>
                        {% endfor %}
                    </div>
                </div>

            </div>
            {% endfor %}
        </div>
    </div>
</div>
<style>
    .abrir_caja {
        display: none;
    }
</style>
<script>
    $('.b_responder').click(function (e) {
        e.preventDefault();
        $(this).next('.abrir_caja').fadeToggle()
    })
</script>


{% endblock %}